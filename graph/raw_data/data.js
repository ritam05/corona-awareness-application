/*
EXPORTS data
data = [{"country" : " ..", "totalDeaths" : [{"date": ".." ,"data" :" .."},..], "totalInfection":[{"date": ".." ,"data" :" .."},..], "totalRecoverd":[{"date": ".." ,"data" :" .."},..]}];
Date will always start from 1st Jan 2020.
*/
const availableCountries = ["India","China", "Korea, South", "Italy", "Spain" ,"United Kingdom", "Iran", "US", ];
const availableStates =["AndhraPradesh","Delhi","Gujarat","JammuAndKashmir","Karnataka","Kerala","MadhyaPradesh","Maharashtra","Rajasthan","TamilNadu","Telengana","UttarPradesh"];

/*Following varibles are defined here for defualt values*/
var selectedCountries = ["India","China","Spain","Iran","Italy"]

var graphDataType="totalDeaths";
var graphStyle="line";
var rgbColor = [ ]
function addColor(r,g,b){
  rgbColor.push({"r": r, "g": g, "b":b});
}
addColor(255,99,71);
addColor(128,0,0);
addColor(255,140,0);
addColor(255,255,0);
addColor(154,205,50);
addColor(85,107,47);
addColor(32,178,170);
addColor(47,79,79);
addColor(138,43,226);
addColor(255,99,71);
addColor(128,0,0);
addColor(255,140,0);
addColor(255,255,0);
addColor(154,205,50);
addColor(85,107,47);
addColor(32,178,170);
addColor(47,79,79);
addColor(138,43,226);
var colorIndex = -1;
function addCountry(name){
  colorIndex++;
  return {
    "country":name,
    "color":rgbColor[colorIndex],
    "index":0,
    "totalDeaths":
      [

      ],
    "totalInfections":
      [

      ],
    "totalRecovered":
      [

      ]
  }
}
var data =
  [

  ]


  var stateData = [
    {
      "State": "AndhraPradesh",

      "10/03": 0,
      "11/03": 0,
      "12/03": 1,
      "13/03": 1,
      "14/03": 1,
      "15/03": 1,
      "16/03": 1,
      "17/03": 1,
      "18/03": 1,
      "19/03": 2,
      "20/03": 3,
      "21/03": 3,
      "22/03": 5,
      "23/03": 7,
      "24/03": 8,
      "25/03": 9,
      "26/03": 11,
      "27/03": 12,
      "28/03": 14,
      "29/03": 19,
      "30/03": 23,
      "31/03": 40,
      "01/04": 83,
      "02/04": 86,
      "03/04": 132,
      "04/04": 161,
      "05/04": 190,
      "06/04": 226,
      "07/04": 266
    },
    {
      "State": "Delhi",

      "10/03": 4,
      "11/03": 5,
      "12/03": 6,
      "13/03": 6,
      "14/03": 7,
      "15/03": 7,
      "16/03": 7,
      "17/03": 8,
      "18/03": 10,
      "19/03": 12,
      "20/03": 17,
      "21/03": 26,
      "22/03": 29,
      "23/03": 29,
      "24/03": 30,
      "25/03": 31,
      "26/03": 36,
      "27/03": 36,
      "28/03": 39,
      "29/03": 50,
      "30/03": 88,
      "31/03": 97,
      "01/04": 152,
      "02/04": 219,
      "03/04": 219,
      "04/04": 445,
      "05/04": 503,
      "06/04": 523,
      "07/04": 576
    },
    {
      "State": "Gujarat",

      "10/03": 0,
      "11/03": 0,
      "12/03": 0,
      "13/03": 0,
      "14/03": 0,
      "15/03": 0,
      "16/03": 0,
      "17/03": 0,
      "18/03": 0,
      "19/03": 0,
      "20/03": 5,
      "21/03": 7,
      "22/03": 18,
      "23/03": 29,
      "24/03": 33,
      "25/03": 38,
      "26/03": 43,
      "27/03": 43,
      "28/03": 45,
      "29/03": 59,
      "30/03": 70,
      "31/03": 73,
      "01/04": 82,
      "02/04": 87,
      "03/04": 95,
      "04/04": 105,
      "05/04": 122,
      "06/04": 144,
      "07/04": 165
    },
    {
      "State": "JammuAndKashmir",

      "10/03": 1,
      "11/03": 1,
      "12/03": 1,
      "13/03": 1,
      "14/03": 2,
      "15/03": 2,
      "16/03": 3,
      "17/03": 3,
      "18/03": 3,
      "19/03": 4,
      "20/03": 4,
      "21/03": 4,
      "22/03": 4,
      "23/03": 4,
      "24/03": 4,
      "25/03": 7,
      "26/03": 13,
      "27/03": 13,
      "28/03": 20,
      "29/03": 31,
      "30/03": 48,
      "31/03": 54,
      "01/04": 62,
      "02/04": 62,
      "03/04": 75,
      "04/04": 75,
      "05/04": 106,
      "06/04": 109,
      "07/04": 116
    },
    {
      "State": "Karnataka",

      "10/03": 1,
      "11/03": 4,
      "12/03": 4,
      "13/03": 6,
      "14/03": 6,
      "15/03": 6,
      "16/03": 6,
      "17/03": 11,
      "18/03": 11,
      "19/03": 14,
      "20/03": 15,
      "21/03": 15,
      "22/03": 26,
      "23/03": 33,
      "24/03": 37,
      "25/03": 41,
      "26/03": 55,
      "27/03": 55,
      "28/03": 55,
      "29/03": 76,
      "30/03": 83,
      "31/03": 83,
      "01/04": 101,
      "02/04": 110,
      "03/04": 124,
      "04/04": 128,
      "05/04": 144,
      "06/04": 151,
      "07/04": 175
    },
    {
      "State": "Kerala",

      "10/03": 9,
      "11/03": 17,
      "12/03": 17,
      "13/03": 19,
      "14/03": 19,
      "15/03": 22,
      "16/03": 23,
      "17/03": 26,
      "18/03": 27,
      "19/03": 27,
      "20/03": 28,
      "21/03": 40,
      "22/03": 52,
      "23/03": 67,
      "24/03": 95,
      "25/03": 109,
      "26/03": 118,
      "27/03": 137,
      "28/03": 176,
      "29/03": 190,
      "30/03": 210,
      "31/03": 234,
      "01/04": 241,
      "02/04": 265,
      "03/04": 286,
      "04/04": 295,
      "05/04": 306,
      "06/04": 314,
      "07/04": 327
    },
    {
      "State": "MadhyaPradesh",

      "10/03": 0,
      "11/03": 0,
      "12/03": 0,
      "13/03": 0,
      "14/03": 0,
      "15/03": 0,
      "16/03": 0,
      "17/03": 0,
      "18/03": 0,
      "19/03": 0,
      "20/03": 0,
      "21/03": 4,
      "22/03": 4,
      "23/03": 6,
      "24/03": 7,
      "25/03": 14,
      "26/03": 20,
      "27/03": 20,
      "28/03": 30,
      "29/03": 30,
      "30/03": 47,
      "31/03": 47,
      "01/04": 66,
      "02/04": 99,
      "03/04": 104,
      "04/04": 104,
      "05/04": 165,
      "06/04": 165,
      "07/04": 229
    },
    {
      "State": "Maharashtra",

      "10/03": 2,
      "11/03": 2,
      "12/03": 11,
      "13/03": 14,
      "14/03": 14,
      "15/03": 32,
      "16/03": 32,
      "17/03": 39,
      "18/03": 42,
      "19/03": 47,
      "20/03": 52,
      "21/03": 63,
      "22/03": 67,
      "23/03": 74,
      "24/03": 89,
      "25/03": 128,
      "26/03": 124,
      "27/03": 130,
      "28/03": 180,
      "29/03": 189,
      "30/03": 201,
      "31/03": 216,
      "01/04": 302,
      "02/04": 335,
      "03/04": 335,
      "04/04": 490,
      "05/04": 490,
      "06/04": 748,
      "07/04": 868
    },
    {
      "State": "Rajasthan",

      "10/03": 2,
      "11/03": 3,
      "12/03": 3,
      "13/03": 3,
      "14/03": 3,
      "15/03": 4,
      "16/03": 4,
      "17/03": 4,
      "18/03": 4,
      "19/03": 7,
      "20/03": 17,
      "21/03": 17,
      "22/03": 24,
      "23/03": 28,
      "24/03": 32,
      "25/03": 36,
      "26/03": 41,
      "27/03": 41,
      "28/03": 54,
      "29/03": 57,
      "30/03": 61,
      "31/03": 74,
      "01/04": 93,
      "02/04": 108,
      "03/04": 167,
      "04/04": 200,
      "05/04": 200,
      "06/04": 274,
      "07/04": 288
    },
    {
      "State": "TamilNadu",

      "10/03": 1,
      "11/03": 1,
      "12/03": 1,
      "13/03": 1,
      "14/03": 1,
      "15/03": 1,
      "16/03": 1,
      "17/03": 1,
      "18/03": 1,
      "19/03": 2,
      "20/03": 3,
      "21/03": 3,
      "22/03": 7,
      "23/03": 9,
      "24/03": 15,
      "25/03": 18,
      "26/03": 26,
      "27/03": 29,
      "28/03": 40,
      "29/03": 55,
      "30/03": 73,
      "31/03": 74,
      "01/04": 234,
      "02/04": 234,
      "03/04": 309,
      "04/04": 411,
      "05/04": 485,
      "06/04": 571,
      "07/04": 621
    },
    {
      "State": "Telengana",

      "10/03": 1,
      "11/03": 1,
      "12/03": 1,
      "13/03": 1,
      "14/03": 1,
      "15/03": 3,
      "16/03": 3,
      "17/03": 5,
      "18/03": 6,
      "19/03": 6,
      "20/03": 17,
      "21/03": 21,
      "22/03": 22,
      "23/03": 32,
      "24/03": 35,
      "25/03": 35,
      "26/03": 44,
      "27/03": 45,
      "28/03": 56,
      "29/03": 76,
      "30/03": 81,
      "31/03": 79,
      "01/04": 96,
      "02/04": 107,
      "03/04": 158,
      "04/04": 159,
      "05/04": 269,
      "06/04": 321,
      "07/04": 364
    },
    {
      "State": "UttarPradesh",

      "10/03": 9,
      "11/03": 9,
      "12/03": 11,
      "13/03": 11,
      "14/03": 12,
      "15/03": 13,
      "16/03": 13,
      "17/03": 15,
      "18/03": 16,
      "19/03": 19,
      "20/03": 23,
      "21/03": 24,
      "22/03": 27,
      "23/03": 31,
      "24/03": 33,
      "25/03": 37,
      "26/03": 41,
      "27/03": 41,
      "28/03": 55,
      "29/03": 66,
      "30/03": 83,
      "31/03": 101,
      "01/04": 103,
      "02/04": 113,
      "03/04": 172,
      "04/04": 174,
      "05/04": 227,
      "06/04": 305,
      "07/04": 305
    }
  ]



  fetch("https://pomber.github.io/covid19/timeseries.json")
    .then(response => response.json())
    .then(d => {

      availableCountries.forEach(country_name => {
        data.push(addCountry(country_name));
        d[country_name].forEach(({ date, confirmed, recovered, deaths }) => {
          data.find(country => country["country"] == country_name)["totalDeaths"].push({"date":date,"data":deaths});
          data.find(country => country["country"] == country_name)["totalInfections"].push({"date":date,"data":confirmed});
          data.find(country => country["country"] == country_name)["totalRecovered"].push({"date":date,"data":recovered});
        });
      });
      availableStates.forEach(state =>
        {
          data.push(addCountry(state));
          var p =stateData.find(s => s["State"] == state);
          for (var key in p)
          {
            if (p.hasOwnProperty(key))
            {
              if(key != "State"){
                data.find(country => country["country"] == state)["totalInfections"].push({"date":key,"data":p[key]});
              }
            }
          }
        });
    });
